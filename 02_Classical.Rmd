# Classical Mechanics {#Classical}

Quantum mechanics cannot be derived from classical mechanics, but classical mechanics can inspire quantum mechanics. Quantum mechanics is richer and more sophisticated than classical mechanics. Quantum mechanics was developed during the period when physicists had rich knowledge of classical mechanics. In order to better understand how quantum mechanics was developed in this environment, it is better to understand some fundamental concepts in classical mechanics. Classical mechanics can be considered as a special case of quantum mechanics. We will review some classical mechanics concepts here.

## Newtonian Formulation
Classical mechanics as formulated by Isaac Newton (1652-1727) is all about forces. Newtonian mechanics works well for problems where we know the forces and have a reasonable coordinate system. In these cases, the net force acting on a system at position $q$ is simply:

\begin{equation}
F_{\mathrm{net}}(q) = m\ddot{q} = m \frac{d^2 q}{dt^2}.
(\#eq:newt1)
\end{equation}

Or, in other words, if we know the net force acting on a system of mass $m$ at position $q$ at some time $t_0$, we can use eq. \@ref(eq:newt1) to calculate the position of the system at any future (or past) time. We have completely determined the dynamical evolution of the system.^[Notice that, in principle, $q$ $\in$ $\mathbb{R}^{n}$ is the position vector and $\dot{q}$ $\in$ $\mathbb{R}^{n}$ is the velocity vector. As such, all the equation of classical mechanics are vector equation, and not just simple numerical equation, as we present them here! For our purposes, we can restrict ourselves to a 1-dimensional space, hence forgetting the complications of vector algebra.]

> ```{example, newtonianEx}

A ball of mass $m$ is at ground level and tossed straight up from an initial position $q_0$ with an initial velocity $\dot{q}_0$ and subject to gravity alone. Calculate the equation of motion for the ball (i.e. where is the ball going to be after some time $t$?).^[This example is based on Rhett Allain's blog post that can be found  (here)[https://rhettallain.com/2018/10/31/classical-mechanics-newtonian-lagrangian-and-hamiltonian/] ]

*Solution:* Since the only force acting on the ball is gravity, we can use the equation for the gravitational force to start our derivation:

\begin{equation}
F_{\mathrm{gravity}}=-mG,
\end{equation}

with $G$ the usual gravitational constant ($G=9.8\; \mathrm{m}/\mathrm{s}^{2}$). We can then replace this expression into eq. \@ref(eq:newt1), to obtain:

\begin{equation}
\begin{aligned}
-mG &=m \ddot{q} \\
-G &=\ddot{q} \\
-G &=\frac{d\dot{q}}{dt}, \\
\end{aligned}
\end{equation}

which can then be integrated with respect to time, to obtain:

\begin{equation}
\begin{aligned}
-G\int_{t=0}^{t} dt &=\int_{\dot{q}_0}^{\dot{q}} d\dot{q}\\
\dot{q} &= \dot{q}_0-Gt\\
\frac{dq}{dt} &= \dot{q}_0-Gt,\\
\end{aligned}
\end{equation}

which can be further integrated with respect to time, to give:

\begin{equation}
\begin{aligned}
\int_{q_0}^{q} dq &= \int_{t=0}^{t} \dot{q}_0 dt -G \int_{t=0}^{t}tdt\\
q &= q_0 + \dot{q}_0 t -\frac{1}{2}Gt^2.
\end{aligned}
\end{equation}

This final equation is the equation of motion for the ball, from which we can calculate the position of the ball at any time $t$. Notice how the equation of motion does not depend on the mass of the ball!

*Numerical problem:* How much time will a ball ejected from a height of $1 \;\mathrm{m}$ at an initial velocity of $10 \;\mathrm{m/s}$ take to hit the floor?

We can use the equation of motion obtained above to solve this problem, and obtain for this specific case $t\simeq2.12\;\mathrm{s}$.^[Can you write a python program to do this calculation?]

```

The formula of Newtonian mechanics are not the only one we can use to solve a problem in classical mechanics. We have at least two other equivalent approaches to the same problem that might end up being more useful in certain situations. 

## Lagrangian Formulation
Another way to derive the equations of motion for classical mechanics is via the use of the Lagrangian and the principle of least action. The Lagrangian formulation is obtained by starting from the definition of the Lagrangian of the system:

\begin{equation}
L = K - V,
(\#eq:lag1)
\end{equation}

where $K$ is the kinetic energy, and $V$ is the potential energy. Both are expressed in terms of the coordinates $(q,\dot{q})$. Notice that for a fixed time, $t$, $q$ and $\dot{q}$ are independent variables, since $\dot{q}$ cannot be derived from $q$ alone. 

The time integral of the Lagrangian is called the **action**, and is defined as:

\begin{equation}
S = \int_{t_1}^{t_2} L\, dt,
(\#eq:lag2)
\end{equation}

which is a functional: it takes in the Lagrangian function for all times between $t_1$ and $t_2$ and returns a scalar value. The equations of motion can be derived from the principle of least action,^[Sometimes also called principle of stationary action, or variational principle, or Hamilton's principle.] which states that the true evolution of a system $q(t)$ described by the coordinate $q$ between two specified states $q_1 = q(t_1)$ and $q_2 = q(t_2)$ at two specified times $t_1$ and $t_2$ is a minimum of the action functional. For a minimum point:

\begin{equation}
\delta S = \frac{dS}{dq}= 0
(\#eq:lag3)
\end{equation}

Requiring that the true trajectory $q(t)$ minimizes the action functional $S$, we obtain the equation of motion (figure \@ref(fig:Fig1c2)^[This diagram is taken from [Wikipedia](https://en.wikipedia.org) by user Maschen, and distributed under CC0 license]). This can be achieved applying classical variational calculus to the variation of the action integral $S$ under perturbations of the path $q(t)$, eq. \@ref(eq:lag3). The resulting equation of motion (or set of equations in the case of many dimensions) is sometimes also called the Euler—Lagrange equation:^[The mathematical derivation of the Euler—Lagrange equaiton is rather long and unimportant at this stage. For the curious, it can be found [here](https://en.wikipedia.org/wiki/Euler–Lagrange_equation).]

\begin{equation}
\frac{d}{dt}\left(\frac{\partial L}{\partial\dot q}\right)=\frac{\partial L}{\partial q}.
(\#eq:lag4)
\end{equation}


```{r Fig1c2, out.width='70%', fig.show='hold', echo=FALSE, fig.align = 'center', fig.cap='Principle of least action: As the system evolves, q traces a path through configuration space (only some are shown). The path taken by the system (red) has a stationary action under small changes in the configuration of the system.'}
knitr::include_graphics('./img/OEP_wiki1.png')
```


> ```{example, lagrangianEx}

Let's apply the Lagrangian mechanics formulas to the same problem as in the previous Example.

The expression of the kinetic energy, the potential energy, and the Lagrangian for our system are:

\begin{equation}
\begin{aligned}
K &= \frac{1}{2}m\dot{q}^2 \\
V &= mGq \\
L &= K-V = \frac{1}{2}m\dot{q}^2 - mGq.
\end{aligned}
\end{equation}

To get the equation of motion using eq. \@ref(eq:lag4), we need to first take the partial derivative of $L$ with respect to $q$ (right hand side):

\begin{equation}
\frac{\partial L}{\partial q}=-mG,
\end{equation}

and then we need the derivative with respect to $t$ the derivative of the Lagrangian with respect to $\dot{q}$ at the  hand side:

\begin{equation}
\frac{d}{dt}\frac{\partial L}{\partial \dot{q}} = \frac{d\left(\frac{1}{2}m\dot{q}^2 - mGq\right)}{dt}= m\ddot{q}.
\end{equation}

Putting this together, we get:

\begin{equation}
\begin{aligned}
m\ddot{q}&=-mG \\
\ddot{q} &= -G \\
\end{aligned}
\end{equation}

Which is the same result as obtained from the Newtonian method.  Integrating twice, we get the exact same formulas that we can use the same way.

```

The advantage of Lagrangian mechanics is that it is not constrained to use a coordinate system. For example, if we have a bead moving along a wire, we can define the coordinate system as the distance along the wire, making the formulas much simpler than in Newtonian mechanics.  Also, since the Lagrangian depends on kinetic and potential energy it does a much better job with constraint forces.


## Hamiltonian mechanics

A third way of obtaining the equation of motion is Hamiltonian mechanics, which uses the generalized momentum in place of velocity as a coordinate. The generalized momentum is defined in terms of the Lagrangian and the coordinates $(q,\dot{q})$:
 
\begin{equation} 
p = \frac{\partial L}{\partial\dot{q}}.
(\#eq:ham1)
\end{equation}

The Hamiltonian is defined from the Lagrangian by applying a Legendre transformation as:^[We have already encountered Legendre transform in [The Live Textbook of Physical Chemistry 1](https://peverati.github.io/pchem1/Potentials.html#thermpot) when transforming from the thermodynamic energy to any of the other thermodynamic potentials.]

\begin{equation} 
H(p,q) = p\dot{q} - L(q,\dot{q}),
(\#eq:ham2)
\end{equation}

The Lagrangian equation of motion becomes a pair of equations known as the Hamiltonian system of equations: 

\begin{equation} 
\begin{aligned}
\dot{p}=\frac{dp}{dt} &= -\frac{\partial H}{\partial q} \\
\dot{q}=\frac{dq}{dt} &= +\frac{\partial H}{\partial p},
\end{aligned}
(\#eq:ham3)
\end{equation}
 
where $H=H(q,p,t)$ is the Hamiltonian of the system, which often corresponds to its total energy. For a closed system, it is the sum of the kinetic and potential energy in the system:

\begin{equation}
H = K + V.
(\#eq:hamdef)
\end{equation}

Notice the difference between the Hamiltonian, eq. \@ref(eq:hamdef), and the Lagrangian, eq. \@ref(eq:lag1). In Newtonian mechanics, the time evolution is obtained by computing the total force being exerted on each particle of the system, and from Newton's second law, the time evolutions of both position and velocity are computed. In contrast, in Hamiltonian mechanics, the time evolution is obtained by computing the Hamiltonian of the system in the generalized momenta and inserting it into Hamilton's equations. This approach is equivalent to the one used in Lagrangian mechanics, since the Hamiltonian is the Legendre transform of the Lagrangian. The main motivation to use Hamiltonian mechanics instead of Lagrangian mechanics comes from the more simple description of complex dynamic systems.

> ```{example, hamex1}
Let's apply the Hamiltonian mechanics formulas to the same problem in the previous examples.

Using eq. \@ref(eq:ham2), the Hamiltonian can be written as:

\begin{equation}
H = m\dot{q}\dot{q} - \frac{1}{2}m\dot{q}^2+mGq = \frac{1}{2}m\dot{q}^2+mGq.
(\#eq:ham4)
\end{equation}

Since the Hamiltonian really depends on position and momentum, we need to get this in terms of $q$ and $p$, with $p = m\dot{q}$ for the momentum. This is not always the case, since it depends on the choice of coordinate system. For a trivial coordinate system for our simple 1-dimensional problem, we have:

\begin{equation}
H=\frac{p^2}{2m}+mGq,
\end{equation}

from which we can use eqs. \@ref(eq:ham3) to get:

\begin{equation}
\begin{aligned}
\dot{q} &= \frac{\partial H}{\partial p} = \frac{p}{m} \\
\dot{p} &=-\frac{\partial H}{\partial q} = -mG.
\end{aligned}
\end{equation}

These equations represent a major diffference of the Hamiltonian method, since we describe the system using two first-order differential equations, rather than one second-order differential equation. In order to get the equation of motion, we need to take the derivative of $\dot{q}$:

\begin{equation}
\ddot{q} = \frac{d}{dt} \left( \frac{p}{m} \right) = \frac{\dot{p}}{m},
\end{equation}

and then replacing the definition of $\dot{p}$ obtained above, we get:

\begin{equation}
\ddot{q} = \frac{-mG}{m} = -G
\end{equation}

which—once again—is the same result obtained for the two previous cases. Integrating this twice, we get the familiar equation of motion for our problem.

```


